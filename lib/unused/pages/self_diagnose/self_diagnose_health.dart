import 'package:flutter/material.dart';

class SelfDiagnoseHealthPage extends StatefulWidget {
  const SelfDiagnoseHealthPage({super.key});

  @override
  _SelfDiagnoseHealthPageState createState() => _SelfDiagnoseHealthPageState();
}

class _SelfDiagnoseHealthPageState extends State<SelfDiagnoseHealthPage> {
  // üîπ K√§ytt√§j√§n vastaukset
  String age = "";
  String height = "";
  String weight = "";
  String gender = "";
  String sleepQuality = "";
  String exerciseLevel = "";
  String dietQuality = "";
  String waterIntake = "";
  String screenTime = "";
  String fatigue = "";
  String stress = "";
  String caffeine = "";
  String headaches = "";
  String smoking = "";
  String alcohol = "";
  String chronicDiseases = "";
  String medications = "";

  void showResults() {
    List<String> recommendations = [];

    if (sleepQuality == "Alle 6 tuntia") {
      recommendations.add(
        "Pyri nukkumaan v√§hint√§√§n 7‚Äì9 tuntia y√∂ss√§ paremman palautumisen takaamiseksi.",
      );
    }
    if (exerciseLevel == "En lainkaan") {
      recommendations.add(
        "S√§√§nn√∂llinen liikunta parantaa terveytt√§si merkitt√§v√§sti. Kokeile lis√§t√§ kevyt liikunta p√§ivitt√§iseen rutiiniisi.",
      );
    }
    if (dietQuality == "Ep√§terveellisesti") {
      recommendations.add(
        "Terveellinen ruokavalio on avain hyvinvointiin. Lis√§√§ ruokavalioosi enemm√§n vihanneksia ja t√§ysjyv√§viljoja.",
      );
    }
    if (waterIntake == "Alle 1 litra") {
      recommendations.add(
        "Juotko tarpeeksi vett√§? Suositus on v√§hint√§√§n 1,5‚Äì2 litraa p√§iv√§ss√§.",
      );
    }
    if (screenTime == "Yli 8 tuntia") {
      recommendations.add(
        "Pid√§ taukoja ruutuajasta v√§hint√§√§n 5‚Äì10 minuutin v√§lein.",
      );
    }
    if (fatigue == "Kyll√§, usein") {
      recommendations.add(
        "Huomaatko usein v√§symyst√§? Kiinnit√§ huomiota uneen, ruokavalioon ja stressinhallintaan.",
      );
    }
    if (stress == "Kyll√§, usein") {
      recommendations.add(
        "Kokeile rentoutusharjoituksia, meditaatiota tai liikuntaa stressitasojen hallintaan.",
      );
    }
    if (caffeine == "Paljon") {
      recommendations.add(
        "V√§henn√§ kofeiinin m√§√§r√§√§, jos huomaat univaikeuksia tai levottomuutta.",
      );
    }
    if (headaches == "Kyll√§, usein") {
      recommendations.add(
        "Tarkista ergonomia, nesteytys ja ruutuaika, jos k√§rsit usein p√§√§ns√§ryst√§.",
      );
    }
    if (smoking == "Kyll√§") {
      recommendations.add(
        "Tupakan v√§hent√§minen tai lopettaminen parantaa terveytt√§si huomattavasti.",
      );
    }
    if (alcohol == "Paljon") {
      recommendations.add(
        "Runsas alkoholink√§ytt√∂ voi vaikuttaa unen laatuun ja terveyteen. Kohtuullinen k√§ytt√∂ on suositeltavaa.",
      );
    }
    if (chronicDiseases == "Kyll√§") {
      recommendations.add(
        "Jos sinulla on pitk√§aikaissairauksia, varmista, ett√§ seuraat tilannettasi l√§√§k√§rin kanssa.",
      );
    }
    if (medications == "Kyll√§") {
      recommendations.add(
        "Varmista, ett√§ l√§√§kityksesi on ajantasainen ja sopii nykyiseen terveydentilaasi.",
      );
    }

    showDialog(
      context: context,
      builder:
          (context) => AlertDialog(
            title: Text('Terveyskartoituksen tulokset'),
            content: SingleChildScrollView(
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children:
                    recommendations.isNotEmpty
                        ? recommendations
                            .map(
                              (rec) => Padding(
                                padding: const EdgeInsets.only(bottom: 8.0),
                                child: Text("‚Ä¢ $rec"),
                              ),
                            )
                            .toList()
                        : [
                          Text(
                            "Terveytesi vaikuttaa olevan hyv√§ll√§ tasolla! Jatka samaan malliin.",
                          ),
                        ],
              ),
            ),
            actions: [
              TextButton(
                onPressed: () => Navigator.pop(context),
                child: Text('Lopeta kysely'),
              ),
            ],
          ),
    );
  }

  Widget _buildTextField(String label, Function(String) onChanged) {
    return Padding(
      padding: const EdgeInsets.symmetric(vertical: 8.0),
      child: TextField(
        decoration: InputDecoration(
          labelText: label,
          border: OutlineInputBorder(),
        ),
        onChanged: onChanged,
      ),
    );
  }

  Widget _buildRadioButtons(
    String label,
    List<String> options,
    String groupValue,
    Function(String) onChanged,
  ) {
    return Padding(
      padding: const EdgeInsets.symmetric(vertical: 8.0),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Text(label, style: TextStyle(fontWeight: FontWeight.bold)),
          Column(
            children:
                options
                    .map(
                      (option) => RadioListTile<String>(
                        title: Text(option),
                        value: option,
                        groupValue: groupValue,
                        onChanged: (value) {
                          if (value != null) {
                            setState(() {
                              onChanged(value);
                            });
                          }
                        },
                      ),
                    )
                    .toList(),
          ),
        ],
      ),
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text("Terveyskysely")),
      body: Column(
        children: [
          Expanded(
            child: ListView(
              padding: EdgeInsets.all(16),
              children: [
                _buildTextField(
                  "Ik√§ (vuosia)",
                  (value) => setState(() => age = value),
                ),
                _buildTextField(
                  "Pituus (cm)",
                  (value) => setState(() => height = value),
                ),
                _buildTextField(
                  "Paino (kg)",
                  (value) => setState(() => weight = value),
                ),

                _buildRadioButtons(
                  "Sukupuoli",
                  ["Mies", "Nainen", "Muu"],
                  gender,
                  (value) => setState(() => gender = value),
                ),
                _buildRadioButtons(
                  "Kuinka monta tuntia nukut y√∂ss√§?",
                  ["Alle 6 tuntia", "6‚Äì8 tuntia", "Yli 8 tuntia"],
                  sleepQuality,
                  (value) => setState(() => sleepQuality = value),
                ),
                _buildRadioButtons(
                  "Kuinka usein harrastat liikuntaa?",
                  ["En lainkaan", "1‚Äì2 kertaa viikossa", "3+ kertaa viikossa"],
                  exerciseLevel,
                  (value) => setState(() => exerciseLevel = value),
                ),
                _buildRadioButtons(
                  "Miten arvioisit ruokavaliosi?",
                  ["Ep√§terveellisesti", "Kohtuullisesti", "Terveellisesti"],
                  dietQuality,
                  (value) => setState(() => dietQuality = value),
                ),
                _buildRadioButtons(
                  "Kuinka paljon vett√§ juot p√§ivitt√§in?",
                  ["Alle 1 litra", "1‚Äì2 litraa", "Yli 2 litraa"],
                  waterIntake,
                  (value) => setState(() => waterIntake = value),
                ),
                _buildRadioButtons(
                  "Kuinka monta tuntia viet√§t ruudun √§√§ress√§ p√§ivitt√§in?",
                  ["Alle 4 tuntia", "4‚Äì8 tuntia", "Yli 8 tuntia"],
                  screenTime,
                  (value) => setState(() => screenTime = value),
                ),
                _buildRadioButtons(
                  "Tunnetko olosi usein v√§syneeksi tai uupuneeksi?",
                  ["Ei", "Joskus", "Kyll√§, usein"],
                  fatigue,
                  (value) => setState(() => fatigue = value),
                ),
                _buildRadioButtons(
                  "Koetko stressi√§ p√§ivitt√§in?",
                  ["Ei", "Joskus", "Kyll√§, usein"],
                  stress,
                  (value) => setState(() => stress = value),
                ),
                _buildRadioButtons(
                  "K√§yt√§tk√∂ kofeiinia p√§ivitt√§in?",
                  ["Ei", "V√§h√§n", "Paljon"],
                  caffeine,
                  (value) => setState(() => caffeine = value),
                ),
                _buildRadioButtons(
                  "Onko sinulla usein p√§√§ns√§rky√§?",
                  ["Ei", "Joskus", "Kyll√§, usein"],
                  headaches,
                  (value) => setState(() => headaches = value),
                ),
                _buildRadioButtons(
                  "Tupakoitko tai k√§yt√§tk√∂ nikotiinituotteita?",
                  ["Ei", "Kyll√§"],
                  smoking,
                  (value) => setState(() => smoking = value),
                ),
                _buildRadioButtons(
                  "K√§yt√§tk√∂ alkoholia?",
                  ["En lainkaan", "Harvoin", "Paljon"],
                  alcohol,
                  (value) => setState(() => alcohol = value),
                ),
                _buildRadioButtons(
                  "Onko sinulla pitk√§aikaissairauksia?",
                  ["Ei", "Kyll√§"],
                  chronicDiseases,
                  (value) => setState(() => chronicDiseases = value),
                ),
                _buildRadioButtons(
                  "K√§yt√§tk√∂ s√§√§nn√∂llist√§ l√§√§kityst√§?",
                  ["Ei", "Kyll√§"],
                  medications,
                  (value) => setState(() => medications = value),
                ),

                // üîπ "N√§yt√§ tulokset" -nappi
                SizedBox(height: 20),
                ElevatedButton(
                  onPressed: showResults,
                  child: Text("N√§yt√§ tulokset"),
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }
}
